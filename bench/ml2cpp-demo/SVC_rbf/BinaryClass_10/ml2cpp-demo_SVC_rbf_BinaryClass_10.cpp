// ******************************************************** 

// This C++ code was automatically generated by ml2cpp (development version).
// Copyright 2020

// https://github.com/antoinecarme/ml2cpp
// Model : SVC_rbf
// Dataset : BinaryClass_10

// This CPP code can be compiled using any C++-17 compiler.
// g++ -Wall -Wno-unused-function -std=c++17 -g -o ml2cpp-demo_SVC_rbf_BinaryClass_10.exe ml2cpp-demo_SVC_rbf_BinaryClass_10.cpp

// Model deployment code

// ******************************************************** 

#include "../../Generic.i"

namespace  {

	std::vector<std::any> get_classes(){
		std::vector<std::any> lClasses = { 0, 1 };

		return lClasses;
	}

	std::vector<std::any> lProblem_data_dual = { 
	 -0.6492523093411626 , -1.0 , -1.0 , -1.0 , -0.4826942779207682 , -1.0 , -1.0 , -1.0 , -1.0 , -0.2720228864367589 , -1.0 , -0.1473052484630992 , -1.0 , -0.8882108852265844 , -1.0 , -0.3949451634313368 , -1.0 , -1.0 , -0.08426596839430542 , -1.0 , -1.0 , -0.7648628362852625 , -1.0 , -0.8078766735723047 , -1.0 , -0.4319957959527412 , 1.0 , 1.0 , 1.0 , 1.0 , 1.0 , 1.0 , 1.0 , 1.0 , 0.3976073712865893 , 0.637216752574423 , 0.2874403785480839 , 0.8591420349606994 , 1.0 , 0.23391424698333904 , 1.0 , 0.20989598511599888 , 1.0 , 0.7483862142143348 , 0.8636658665580722 , 1.0 , 0.9643610685229934 , 0.845818890080592 , 0.42508585464638854 , 0.36525932948332385 , 0.7162326457025632 , 1.0 , 0.3694054063469224 ,};
	

	std::vector<std::vector<std::any> > lProblem_data_sv = { 
	 { 1.4381247966295068, 0.6635392845773066, 1.6998893753270106, 0.9567405573635612, -1.7516253433919915, -0.8430319931766532, 0.5014356702225439, 0.5279311312920253, -1.1850456651959491, -1.2898557344951027 },
	 { 2.120069912015655, -1.3157115383923255, 0.6429642863228179, 0.6610814484957174, 0.36596290608041254, -2.5491721699014698, 0.06129702661697322, 0.7115638190536748, 1.8302433276613608, -1.6023004406952328 },
	 { 0.4809672098030855, 1.9281234723864962, 0.5386834807895613, 0.9128267937845747, 2.0958556488784024, -0.27086036412995806, -0.7857194492739092, 0.1771275259206786, 1.4050432480605073, -0.43391845713831423 },
	 { -0.21613870478849442, -0.5303212005433303, -0.5362164085336691, -0.8100387031157575, -0.9615662898307464, 1.5529718576848406, -0.4595236871795928, -0.006514794174079089, -1.8130818762045466, -0.13279488760020075 },
	 { 0.7339940477298028, 1.2871465673488465, 0.1875901783233878, 0.2966329388539434, -0.6550736725587594, -0.5667448842766283, 0.9345774254716126, 0.26247811680900424, 0.17933865710548139, -0.6270638499836759 },
	 { -0.05213379204679852, 0.14498787583333014, 0.5340592256715511, 1.4321952389465753, 0.738275982301284, 1.4341442375220592, 0.033602057890890415, 0.052532412603893186, -0.8806903984842515, -0.27469508368586715 },
	 { 0.1609673651304091, 0.31951315402216107, 1.421875453224298, 1.0901295605582688, 0.21308828842752156, 1.6377496951258501, -0.919723457692772, 0.14753655567089496, 0.5686299031785073, -0.5410659754384293 },
	 { -0.759932229366612, 0.552805168880046, -0.23487363635190292, -1.2701421722716257, 1.456377543159662, 1.5435117281327027, 2.8107702281511435, -0.2229001278703461, 0.6172442977370132, 0.4301073180538011 },
	 { 0.785560584884625, 1.0733430351073072, 0.12853183489140385, -0.566243175109869, -1.481913963837002, -0.8386241389093972, 0.26604319157707085, 0.2690687200903063, 1.271598798688941, -0.6179701490256493 },
	 { 1.0241535877780805, -1.0495224376120962, -0.26852046676993463, 1.7226040722993716, 0.9380136904955607, 0.13018473131083308, -0.08032563816377523, 0.41326713765304607, -2.040113803171429, -1.0858768663310276 },
	 { 1.1402573781685328, 0.6761804068245167, -1.4731268041595753, 0.7323942062420845, 1.4964566535823185, -1.4683569412740674, 1.124026130806446, 0.3777381705418596, -0.2543842002580888, -0.8394938690129621 },
	 { 0.7430089011960362, -0.23929647235393137, -0.9541511016410574, 1.3310869796087246, 0.6575038895002946, 0.20938692944407888, -0.34219217399760216, 0.30568856533648076, -0.50121130930097, -0.8141122002000563 },
	 { 0.5373565697566288, -0.04690948394036747, 0.29555831849829717, -2.8951397669851433, 1.2621190656210834, -0.7719309323277832, -0.9937390191746367, 0.17392983723693703, -0.3093235091111961, -0.37730757660701 },
	 { 1.4707105326593743, 0.6311035489040773, -2.8012908337953695, 1.1813381968736358, 0.38748490651690554, -0.04500376296944053, -0.24046266634057512, 0.5816180116060542, -1.8316894690704832, -1.506224126659428 },
	 { 0.407462944576994, 1.3739520090723474, -0.32708625268269326, -0.4957144018056562, 0.5225386626750229, 1.831605600663067, -0.6450938560071097, 0.25530144489299267, 0.27881375828154403, -0.839638825731542 },
	 { 1.5314880717921968, -1.1221448073812108, -1.074653972221543, -1.738666070442788, 2.989596347044145, -1.0283177254545857, -0.4299666693658347, 0.555537975745693, -0.5240372776217319, -1.3436929393692052 },
	 { 0.5799864121318057, -0.2360313038841518, 0.43505579564303826, 1.3393898952948147, -1.8861454098888544, 0.020294743576157792, -0.6292571849498783, 0.23130823452460433, -1.4508741930862805, -0.6027040800554819 },
	 { -0.011908999728864111, -0.8908065351122083, -0.5063606992712224, -0.24282406881234603, 0.143574433900628, 1.4442721907375726, 0.6468644070009625, 0.0690200161630706, -1.3533365355738265, -0.318492636197919 },
	 { 1.120875660247202, -0.14490823792584728, -1.9001775986599596, -2.5665062657480977, -0.5387631944075266, -0.7631383016967406, 0.6232385849324242, 0.4060533232018754, -0.24894790224859287, -0.9810201396152777 },
	 { -0.8832766812818473, 0.501049774810359, 0.2479598674358872, 0.8693112756683995, 1.996147651770403, 2.380376125070892, 2.614818878550584, -0.2291391162693423, -0.0650419737088196, 0.3656327705757887 },
	 { 0.7262866594357859, -0.13694221346809365, 1.87537250288579, 1.5235357221633312, -0.46089293180940766, -0.9708223054007781, -0.01178577032390541, 0.2387848231935976, -0.20550758304272917, -0.5265729999445877 },
	 { 0.18655656472286322, 0.7018565551129017, -0.17237723790595258, -1.0262469401396512, -1.4151234456298987, 0.08522945062564924, 2.265435222000944, 0.07842056410455177, -0.020740240980986667, -0.21188837313984477 },
	 { -0.3072178920094768, -0.08419770648067697, -0.1306274931517295, 0.5603600953691231, -1.2195669450232594, 1.3176176696171835, 1.4264140211857006, -0.05469374139869011, 1.1876901315295343, 0.015023609022383422 },
	 { 1.500082483628606, 0.7267781109547563, 1.0387824703914883, -0.8148060664558938, 0.8037679440680124, -1.8765009447783967, 1.0831079837281372, 0.4997586069227328, -0.5427918958620014, -1.1170547782092501 },
	 { 1.7096089096467344, -1.7206740883924276, 0.4931714251821265, 0.6008116937038641, -0.0867360316949045, -2.188319868387153, 0.36860794553175896, 0.5670245831625101, -1.0950674272441343, -1.2616951306848285 },
	 { 1.7406428436664605, -1.770495386387641, -0.07463878241592434, -0.0037948497623813615, -1.235391494814571, -2.182202011378088, 0.23688793275339634, 0.5796583755941385, 0.30964558622762334, -1.2950970729805795 },
	 { 0.651195525977357, -0.08936038423557587, 1.9966011707973088, 0.6138413720482201, -0.24829220161063323, -2.1003752138660037, -0.5243777808662209, 0.15129352930018047, -0.6087374876863917, -0.19044790673420153 },
	 { 0.16975708565977984, 0.5745901873736575, 0.13520582022086736, 1.235580504196008, -0.7909057983300439, -0.9991732885159312, 0.3046585722264628, 0.016378282006633726, -2.0380997713438007, 0.05378850572963312 },
	 { 0.8652416164274608, -1.2494742219861754, 1.970456348555097, 0.02323201628587036, -0.7534053731189334, -1.2056689228229833, 2.158241115300078, 0.2819622213989109, 0.9519093576303396, -0.6160716913329085 },
	 { 0.1019725646490372, 1.1685511812029383, 1.16463972680708, -1.322897896328765, -0.81831930171055, -1.613089725148296, -0.6318915732239502, -0.04188234680584454, -1.7397547050645301, 0.2642863364515001 },
	 { 0.23592163546645983, 0.01559558553610639, -0.14752596910266838, -1.2939361435540477, -2.1277947525067775, 2.9511133894725567, -2.063295162834261, 0.2443593613004832, -1.6533000080360474, -0.9191469810556254 },
	 { 0.5954228223112823, 1.070088205789964, 1.6359734751574904, 1.8207530511515095, 1.058171013210782, -1.4969966417968363, -0.16104490427296092, 0.15996015820788406, -0.9675784633481913, -0.2711256206763759 },
	 { 0.8309376943018076, 0.3494158747839881, -0.4786555924059382, 1.0978825983775917, 0.3928388355825836, -2.057693229890982, 0.5622815503608488, 0.22483599160616763, 1.1352549387252504, -0.38556519714981885 },
	 { -0.6557259046238674, -0.19753543035285562, -0.3870102338535069, 0.12240188653634958, 0.8587294067401514, 1.6830499480545718, -0.1682619880379936, -0.17440192412254285, -1.4901396843996222, 0.2906968375895972 },
	 { -0.9362057255475571, -0.11352248037217438, 1.061984565910281, 0.22418695911281536, 0.4715198809820012, 0.8367092508536015, -0.5758290809477716, -0.3289771205869928, 0.03846674558083296, 0.7737472491326887 },
	 { -0.060448736905912626, -0.11125683859707515, 0.021022926526784357, 0.6800389448678937, 1.9737574262819368, -1.5110360621219798, 0.3358890911364689, -0.10115733393436173, 0.15007426791522938, 0.4083952183013907 },
	 { -1.9663310693948426, -0.8234440790714608, 0.1888688624711014, 1.379437953273724, -2.594699659221376, 0.4408191812641993, 1.2533880835073579, -0.7581828203224484, -1.117434817605979, 1.9266347626423652 },
	 { -0.771540268926696, 1.46903207688595, -2.019076907942007, -0.5135675470364792, 1.0965351526985396, 1.6038820415606125, -0.6080326284525016, -0.2244262032219191, -0.32058268918214206, 0.42825077343097584 },
	 { -0.7525174599184026, 1.3825524761202033, -0.8479737534640933, -0.20086204414810277, -0.8003673053468898, 1.4494724426104775, -0.3292842942877819, -0.22475813015584867, 0.8669609737617006, 0.4439987706498345 },
	 { -1.1409661724101745, -0.3463541301131144, 0.7379869754948905, -0.2900040524105142, -1.7885360709318514, 1.7667109334962625, -0.24873961548043694, -0.3627848624512894, 1.3419906953654295, 0.7718945892552856 },
	 { -1.0458024423037, 0.11294939926527063, 0.46891997076276926, -0.7604854545960222, 0.1357802035153995, 1.4757603465643656, 0.5220718295742688, -0.33985870226752574, -0.48017811399063987, 0.740400599203569 },
	 { -1.093374409702152, 0.9475980125219733, -0.9017238789248192, 1.1646152166358184, -0.4394617001393151, 0.9439394406278055, 0.6299116301591762, -0.38590233494303533, -1.3631221654569208, 0.9112543186798081 },
	 { 1.0713755931512898, -0.6341929930213883, -0.8608076793809787, 1.7692639439055955, -0.15206514397570287, -1.8162569729750924, 2.0157523076551636, 0.33262537551495386, -0.16263678202300752, -0.6887886691414953 },
	 { 0.012065042254881864, 0.4443892983426857, -1.4697913688875572, 0.4517222860649883, -1.7368938491583985, -1.460865852935286, -0.33760275685003066, -0.06980537759852712, 1.4704670843488727, 0.3221320752206227 },
	 { -0.11191428863440406, -2.9539110781648725, -0.5048346440293533, -0.12704048004071272, 1.6484754725778463, -1.9936263313135245, -0.5213253200352531, -0.14623299324600858, -1.9489722219040737, 0.5719888420200394 },
	 { 0.9140539237335175, 0.6044433177877142, 0.2676507811668582, 1.2566586429636435, -0.01805437836471338, -1.47801475508027, 0.6098850048713202, 0.28743548849606926, -0.16838677020388274, -0.6040310941183635 },
	 { -0.7343297083876039, -1.4265880639004551, -0.7806625074373339, 1.4639499794023008, 0.1109836453347228, 1.44260052921336, 1.0532796207373882, -0.21788794697036953, 1.0197140596407803, 0.42681820458385533 },
	 { 0.4072512631016443, 2.0466987867534647, -3.9912885179936213, 0.8382817661390957, 0.5407473106323089, 2.56928102879518, 2.434235523534455, 0.2928850016560724, 0.31899439638934446, -1.008365758437452 },
	 { -0.9842478520884335, 1.9378098213560637, 1.9009645965187745, 1.0225965404741875, 1.0177323969292706, 0.42791816616792433, -1.3637383386684128, -0.36892520205430207, -0.7573078864848414, 0.9169090219782268 },
	 { -1.1514504000938182, 0.3319921748636244, -0.3986449371602447, -2.0059250471778616, -1.1837022225187166, -1.3402528677516417, -0.8862663250298513, -0.5255969598941366, 3.070620490630201, 1.4942740266821413 },
	 { -1.029643186776298, -0.9773916285069058, 1.7550829759782132, 0.9122481516887383, -0.08196737041614892, 1.2232824746020043, 0.636305156382388, -0.3463351631986256, 1.810402402770992, 0.7815613307777305 },
	 { 0.3366652264555634, -0.5583924823639528, -1.635627281588523, -0.5058003865138625, -0.2227444485320821, 2.904163322602534, 0.4913350109051379, 0.28196018574523973, 0.9444309886480903, -1.01227659411881 },
	 { -3.7187974972853914, 0.6134728139942742, 0.5522043442253135, 1.2505521474548902, -0.22534264711586277, -1.4417236873485972, -0.29157358796271793, -1.5500918179821856, 1.7327983780353353, 4.164846993310231 },
	};
	

	double get_problem_0_1_decision_function( std::vector<std::any> const & inputs) {
		return rbf_kernel( lProblem_data_dual, lProblem_data_sv, inputs, 0.08521040392156176 ) + 0.3345583590602313;
	}
	

	std::vector<std::string> get_input_names(){
		std::vector<std::string> lFeatures = { "Feature_0", "Feature_1", "Feature_2", "Feature_3", "Feature_4", "Feature_5", "Feature_6", "Feature_7", "Feature_8", "Feature_9" };

		return lFeatures;
	}

	std::vector<std::string> get_output_names(){
		std::vector<std::string> lOutputs = { 
			"Score_0", "Score_1",
			"Proba_0", "Proba_1",
			"LogProba_0", "LogProba_1",
			"Decision", "DecisionProba" };

		return lOutputs;
	}

	tTable compute_classification_scores(std::any Feature_0, std::any Feature_1, std::any Feature_2, std::any Feature_3, std::any Feature_4, std::any Feature_5, std::any Feature_6, std::any Feature_7, std::any Feature_8, std::any Feature_9) {
		auto lClasses = get_classes();

		std::vector<std::any> inputs = { Feature_0, Feature_1, Feature_2, Feature_3, Feature_4, Feature_5, Feature_6, Feature_7, Feature_8, Feature_9 };

		std::any lDotProduct_0_1 = rbf_kernel( lProblem_data_dual, lProblem_data_sv, inputs, 0.08521040392156176 ) + 0.3345583590602313;

		std::any lLogistic_0_1 = logistic(-3.571852953233168 * lDotProduct_0_1 + 0.11827401734580012);


		tTable lTable;

		lTable["Score"] = { 
			-lDotProduct_0_1,
			lDotProduct_0_1 
		} ;
		lTable["Proba"] = { 
			lLogistic_0_1,
			1.0 - lLogistic_0_1 
		} ;
		int lBestClass = get_arg_max( lTable["Proba"] );
		auto lDecision = lClasses[lBestClass];
		lTable["Decision"] = { lDecision } ;
		lTable["DecisionProba"] = { lTable["Proba"][lBestClass] };

		recompute_log_probas( lTable );

		return lTable;
	}

	tTable compute_model_outputs_from_table( tTable const & iTable) {
		tTable lTable = compute_classification_scores(iTable.at("Feature_0")[0], iTable.at("Feature_1")[0], iTable.at("Feature_2")[0], iTable.at("Feature_3")[0], iTable.at("Feature_4")[0], iTable.at("Feature_5")[0], iTable.at("Feature_6")[0], iTable.at("Feature_7")[0], iTable.at("Feature_8")[0], iTable.at("Feature_9")[0]);

		return lTable;
	}

} // eof namespace 


int main() {
	score_csv_file("outputs/ml2cpp-demo/datasets/BinaryClass_10.csv");
	return 0;
}
