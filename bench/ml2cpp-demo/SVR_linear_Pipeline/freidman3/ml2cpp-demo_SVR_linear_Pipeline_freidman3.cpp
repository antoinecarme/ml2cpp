// ******************************************************** 

// This C++ code was automatically generated by ml2cpp (development version).
// Copyright 2020

// https://github.com/antoinecarme/ml2cpp
// Model : SVR_linear_Pipeline
// Dataset : freidman3

// This CPP code can be compiled using any C++-17 compiler.
// g++ -Wall -Wno-unused-function -std=c++17 -g -o ml2cpp-demo_SVR_linear_Pipeline_freidman3.exe ml2cpp-demo_SVR_linear_Pipeline_freidman3.cpp

// Model deployment code

// ******************************************************** 

#include "../../Generic.i"

namespace  {

	namespace imputer {
	
		std::vector<std::string> get_input_names(){
			std::vector<std::string> lFeatures = { "Feature_0", "Feature_1", "Feature_2", "Feature_3" };
	
			return lFeatures;
		}
	
		std::vector<std::string> get_output_names(){
			std::vector<std::string> lOutputs = { "imputer_output_2", "imputer_output_3", "imputer_output_4", "imputer_output_5" };
	
			return lOutputs;
		}
	
		tTable compute_features(std::any Feature_0, std::any Feature_1, std::any Feature_2, std::any Feature_3) {
	
			tTable lTable;
	
			lTable["imputer_output_2"] = { ((Feature_0 == std::any()) ?  ( 43.79128122207401 ) : ( Feature_0)) };
			lTable["imputer_output_3"] = { ((Feature_1 == std::any()) ?  ( 945.9672833084396 ) : ( Feature_1)) };
			lTable["imputer_output_4"] = { ((Feature_2 == std::any()) ?  ( 0.5310009099975209 ) : ( Feature_2)) };
			lTable["imputer_output_5"] = { ((Feature_3 == std::any()) ?  ( 6.139967152050499 ) : ( Feature_3)) };
	
			return lTable;
		}
	
		tTable compute_model_outputs_from_table( tTable const & iTable) {
			tTable lTable = compute_features(iTable.at("Feature_0")[0], iTable.at("Feature_1")[0], iTable.at("Feature_2")[0], iTable.at("Feature_3")[0]);
	
			return lTable;
		}
	
	} // eof namespace imputer
	

	namespace scaler {
	
		std::vector<std::string> get_input_names(){
			std::vector<std::string> lFeatures = { "imputer_output_2", "imputer_output_3", "imputer_output_4", "imputer_output_5" };
	
			return lFeatures;
		}
	
		std::vector<std::string> get_output_names(){
			std::vector<std::string> lOutputs = { "scaler_output_2", "scaler_output_3", "scaler_output_4", "scaler_output_5" };
	
			return lOutputs;
		}
	
		tTable compute_features(std::any imputer_output_2, std::any imputer_output_3, std::any imputer_output_4, std::any imputer_output_5) {
	
			tTable lTable;
	
			lTable["scaler_output_2"] = { ( ( imputer_output_2 - 43.79128122207401 ) / 26.03562357622511 ) };
			lTable["scaler_output_3"] = { ( ( imputer_output_3 - 945.9672833084396 ) / 461.4552766146446 ) };
			lTable["scaler_output_4"] = { ( ( imputer_output_4 - 0.5310009099975209 ) / 0.2901863282144786 ) };
			lTable["scaler_output_5"] = { ( ( imputer_output_5 - 6.139967152050499 ) / 3.072917242564058 ) };
	
			return lTable;
		}
	
		tTable compute_model_outputs_from_table( tTable const & iTable) {
			tTable lTable = compute_features(iTable.at("imputer_output_2")[0], iTable.at("imputer_output_3")[0], iTable.at("imputer_output_4")[0], iTable.at("imputer_output_5")[0]);
	
			return lTable;
		}
	
	} // eof namespace scaler
	

	namespace model {
	
		std::vector<std::any> lProblem_data_dual = { 
		 -0.1 , -0.1 , -0.1 , 0.1 , 0.1 , -0.1 , -0.1 , -0.1 , -0.1 , 0.1 , -0.1 , 0.1 , 0.053319282490783174 , -0.1 , 0.1 , 0.1 , 0.012950403581427957 , 0.1 , 0.060729401611386874 , -0.027664176381396306 , -0.1 , 0.1 , 0.1 , -0.1 , 0.1 , -0.048905910687179914 , 0.04957099938497819 ,};
		
	
		std::vector<std::vector<std::any> > lProblem_data_sv = { 
		 { -0.12862954071664834, -0.855762437264239, -1.6966276928077146, -0.5082762490187378 },
		 { -0.21286186615867886, -1.7554500325668299, 0.40296624747161036, -1.2888423126888915 },
		 { 0.26229505103186884, -1.156436226701534, -1.469826707772466, -1.0591196409203139 },
		 { -1.3354814047760004, -0.97426350987175, -0.3716476350789736, 0.7811055410829204 },
		 { 1.4868985426195895, -0.9329759232521928, 0.00976547361007169, -0.44029399823160686 },
		 { 2.1576338377007738, -1.5960266405607315, 0.8932409458054494, -1.4115808580223888 },
		 { 0.7344011353085581, -1.0612795690667527, -1.6427206707260704, 1.2838987122205305 },
		 { -0.18528042847112391, 0.4699482106570824, -1.7832778948365522, 0.2085342932233457 },
		 { -1.1306530181901988, 1.693815859594952, -1.8098491932723488, -0.8531150536577624 },
		 { -1.468587753657723, 0.7062658577112757, -0.9158552800517019, -1.2834679369913997 },
		 { -1.3038701382176308, 1.5082277717144996, 0.6083460261972142, -0.0497929633220157 },
		 { 0.9728908499577125, 0.5638179474733811, -0.9647633676782364, -0.35511879074667424 },
		 { 1.0009695683627862, 1.502114679360407, -0.34917308534153296, 0.4309174307293153 },
		 { -0.17541648253457842, 1.157357979471062, 1.5460776435053638, 1.5614840452774303 },
		 { 0.6164412059817497, 0.5135313271464818, 0.1901494810656995, -1.1516753084142997 },
		 { 1.2264841754879965, 0.07275199619597457, -0.6438669259586074, 0.17898018904797883 },
		 { -0.5031732278135369, 0.679095067810605, -0.9279147679691655, -0.08886958441441088 },
		 { -0.026701854468432252, -0.028542073748357124, -0.7442367085789723, 0.1618427895801297 },
		 { -1.3530021564771337, 0.47937339709127175, -1.0882400181353251, 1.4264179411454836 },
		 { 1.2560974505775302, -1.5734959921280032, 0.806979259164098, 0.18593850041668145 },
		 { -0.08482514143628933, -1.1068716787463535, -1.4854147384149081, -1.1904103710707925 },
		 { -1.6763217237163097, -1.4763345216405568, -0.11470085787237269, 0.8503538460077694 },
		 { -1.6242802893869952, -1.775508653244122, -0.6568131609880984, 1.1953045443253554 },
		 { -1.0669924080933233, -0.7524462900242421, -1.628861728957462, 1.2775885380398857 },
		 { 0.16718440174526195, -0.4007044787483432, -0.770256515182922, -1.6235051493651826 },
		 { -1.6143668628687107, -0.2665480603895422, 1.3614338477237014, 1.174351653344988 },
		 { -0.923065553671842, -1.460057588221313, -0.28039707608225506, -1.3915237626329608 },
		};
		
	
		std::vector<std::string> get_input_names(){
			std::vector<std::string> lFeatures = { "scaler_output_2", "scaler_output_3", "scaler_output_4", "scaler_output_5" };
	
			return lFeatures;
		}
	
		std::vector<std::string> get_output_names(){
			std::vector<std::string> lOutputs = { "Estimator" };
	
			return lOutputs;
		}
	
		tTable compute_regression(std::any scaler_output_2, std::any scaler_output_3, std::any scaler_output_4, std::any scaler_output_5) {
			std::vector<std::any> inputs = { scaler_output_2, scaler_output_3, scaler_output_4, scaler_output_5 };
	
			std::any lDotProduct = linear_kernel( lProblem_data_dual, lProblem_data_sv, inputs ) + 1.3830962534546885;
	
	
			tTable lTable;
	
			std::any  lEstimator = lDotProduct;
			lTable[ "Estimator" ] = { lEstimator };
	
			return lTable;
		}
	
		tTable compute_model_outputs_from_table( tTable const & iTable) {
			tTable lTable = compute_regression(iTable.at("scaler_output_2")[0], iTable.at("scaler_output_3")[0], iTable.at("scaler_output_4")[0], iTable.at("scaler_output_5")[0]);
	
			return lTable;
		}
	
	} // eof namespace model
	

	std::vector<std::string> get_input_names(){
		std::vector<std::string> lFeatures = { "Feature_0", "Feature_1", "Feature_2", "Feature_3" };

		return lFeatures;
	}

	std::vector<std::string> get_output_names(){
		std::vector<std::string> lOutputs = { "Estimator" };

		return lOutputs;
	}

	tTable compute_regression(std::any Feature_0, std::any Feature_1, std::any Feature_2, std::any Feature_3) {
		tTable lTable_imputer = imputer::compute_features(Feature_0, Feature_1, Feature_2, Feature_3);

		tTable lTable_scaler = scaler::compute_model_outputs_from_table( lTable_imputer );

		tTable lTable_model = model::compute_model_outputs_from_table( lTable_scaler );


		tTable lTable;

		std::any  lEstimator = lTable_model[ "Estimator" ][0];
		lTable[ "Estimator" ] = { lEstimator };

		return lTable;
	}

	tTable compute_model_outputs_from_table( tTable const & iTable) {
		tTable lTable = compute_regression(iTable.at("Feature_0")[0], iTable.at("Feature_1")[0], iTable.at("Feature_2")[0], iTable.at("Feature_3")[0]);

		return lTable;
	}

} // eof namespace 


int main() {
	score_csv_file("outputs/ml2cpp-demo/datasets/freidman3.csv");
	return 0;
}
